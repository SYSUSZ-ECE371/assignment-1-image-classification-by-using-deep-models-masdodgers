[![Review Assignment Due Date](https://classroom.github.com/assets/deadline-readme-button-22041afd0340ce965d47ae6ef1cefeee28c7c493a6346c4f15d667ab976d596c.svg)](https://classroom.github.com/a/VkJVVOAn)
[![Open in Visual Studio Code](https://classroom.github.com/assets/open-in-vscode-2e0aaae1b6195c2367325f4f02e2d04e9abb55f0b24a779b69b11b9e10269abc.svg)](https://classroom.github.com/online_ide?assignment_repo_id=19524010&assignment_repo_type=AssignmentRepo)


# Flower Image Classification with MobileNetV2 and ResNet18

This project implements an image classification task for flower images using deep learning models. The dataset consists of 5 categories of flowers, and two different models—MobileNetV2 and ResNet18—are trained and evaluated. The project is divided into two main sections: one for MobileNetV2 using **MMClassification** and the other using **PyTorch** with **ResNet18**.

## Project Structure

```
EX1/
├── configs/                    # Configuration files for MobileNetV2 (MMClassification)
├── work_dirs/                  # Model output directories (logs, checkpoints)
│   └── flower_mobilenetv2/
├── generate_metadata.py        # Script to generate metadata for the dataset
└── split_dataset.py            # Script to split the dataset into train and validation sets

EX2/
├── work_dir/                   # Directory for saving results in PyTorch training
├── ECE371_Assignment1.pdf      # Report for Assignment 1
├── main.py                     # PyTorch-based training script for flower classification
└── README.md                   # Project overview and instructions
```

## Requirements

* Python 3.x
* PyTorch 1.12.1+ with CUDA 11.3 support
* torchvision 0.13.1+
* MMClassification 0.24.1+
* Other libraries: `matplotlib`, `scikit-learn`, `tqdm`

You can install the necessary dependencies using:

```
pip install -r requirements.txt
```

## Dataset

The dataset consists of images of flowers in 5 categories: **Daisy**, **Dandelion**, **Rose**, **Sunflower**, and **Tulip**. The dataset is organized as follows:

```
flower_dataset/
├── train/
│   ├── daisy/
│   ├── dandelion/
│   ├── rose/
│   ├── sunflower/
│   └── tulip/
├── val/
│   ├── daisy/
│   ├── dandelion/
│   ├── rose/
│   ├── sunflower/
│   └── tulip/
└── classes.txt
```

## Getting Started

### 1. Prepare the Dataset

To split the dataset into training and validation sets, run the script:

```
python split_dataset.py
```

This script will split the data into an 80% training set and a 20% validation set. Ensure that the dataset is located in the `flower_dataset_raw` directory.

### 2. Training MobileNetV2 Model (MMClassification)

To train the MobileNetV2 model using **MMClassification**, you can use the configuration files in the `configs/` directory. Simply run the following command:

```
python tools/train.py configs/mobilenet_v2/flower_mobilenetv2.py --work-dir work_dirs/flower_mobilenetv2
```

The logs and checkpoints will be saved in the `work_dirs/flower_mobilenetv2/` directory.

### 3. Training ResNet18 Model (PyTorch)

To train the ResNet18 model using **PyTorch**, run the script:

```
python main.py
```

This script will train the model and save the best model weights in the `EX2/work_dir/` folder as `best.pth`. Additionally, training curves (loss and accuracy) will be saved as `training_curves.png`.

### 4. Evaluate the Model

Once training is complete, you can evaluate the model performance by loading the best saved model (`best.pth`) and testing it on the validation set.

### 5. Visualizing Results

The training process will generate the following visualizations:

* **Loss Curve**: Plots the training and validation loss over the epochs.
* **Accuracy Curve**: Plots the training and validation accuracy over the epochs.
* **Confusion Matrix** (Optional): Can be generated by running a separate script to visualize classification errors.


